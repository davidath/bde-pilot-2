EXEC=/mnt/disk1/thanasis/hysplit/hysplit/trunk/exec
WRF_IN=
STATIONS=STATIONS=44.321_28.054_CERNAVODA 43.7402_23.7806_KOZLODUY 52.035_9.41_GROHNDE 52.472_7.321_EMSLAND 52.211_1.622_SIZEWELL 51.208_-3.127_HINKLEY 39.211_-1.0514_COFRENTES 39.8072_-5.6983_ALMARAZ 60.367_26.35_LOVIISA 60.4_18.167_FORSMARK 57.25_12.117_RINGHALS 47.817_31.217_SUKRAINE 50.3023_26.517_KHMELNITSKY 46.574_18.853_PAKS 46.9384_15.5154_KRSKO 40.9507_0.8652_VANDELLOS 51.33_4.25_DOEL 54.031_-2.916_HEYSHAM

clean::
	rm -f $(EXEC)/123.BIN
	rm -f $(EXEC)/WRFDATA.CFG
	rm -f $(EXEC)/ARLDATA.CFG
	rm -f $(EXEC)/cdump
	rm -f $(EXEC)/WRFRAIN.BIN
	rm -f $(EXEC)/CONC.CFG


convert_f::
	cd $(EXEC);\
	./arw2arl -i$(WRF_IN) -o123.BIN

conc_f::
	cd $(EXEC);\
	year=`echo $(WRF_IN)|awk -F "_" '{print $$3}'`;\
	day=`echo $(WRF_IN)|awk -F "_" '{print $$4}'`;\
	syr=`echo $$year|awk -F "-" '{print $$1}'`;\
	smo=`echo $$year|awk -F "-" '{print $$2}'`;\
	sday=`echo $$year|awk -F "-" '{print $$3}'`;\
	shr=`echo $$day|awk -F ":" '{print $$1}'`;\
	ssyr=`echo $$syr|tail -c 3`;\
	echo ">>> $$ssyr $$smo $$sday $$shr";\
	label=`echo "$$ssyr-$$smo-$$sday-$$shr"`;\
	echo "=----$$label";\
	mkdir -p $$label;\
	for i in $(STATIONS); do \
		if [ -f CONTROL ];then rm CONTROL; fi;\
		x=`echo $$i|awk -F"_" '{print $$1}'`;\
		y=`echo $$i|awk -F"_" '{print $$2}'`;\
		name=`echo $$i|awk -F"_" '{print $$3}'`;\
		echo "$$ssyr $$smo $$sday $$shr">>CONTROL;\
		echo "1                      ">>CONTROL;\
		echo "$$x $$y 10.0           ">>CONTROL;\
		echo "72                     ">>CONTROL;\
		echo "0                      ">>CONTROL;\
		echo "10000.0                ">>CONTROL;\
		echo "1                      ">>CONTROL;\
		echo "./                     ">>CONTROL;\
		echo "123.BIN          ">>CONTROL;\
		echo "2                      ">>CONTROL;\
		echo "C137                   ">>CONTROL;\
		echo "360.0                  ">>CONTROL;\
		echo "72.0                   ">>CONTROL;\
		echo "00 00 00 00 00         ">>CONTROL;\
		echo "I131                   ">>CONTROL;\
		echo "360.0                  ">>CONTROL;\
		echo "72.0                   ">>CONTROL;\
		echo "00 00 00 00 00         ">>CONTROL;\
		echo "1                      ">>CONTROL;\
		echo "53.0 15.0              ">>CONTROL;\
		echo "0.1 0.1                ">>CONTROL;\
		echo "50.0 50.0              ">>CONTROL;\
		echo "./                     ">>CONTROL;\
		echo "cdump                  ">>CONTROL;\
		echo "1                      ">>CONTROL;\
		echo "100                    ">>CONTROL;\
		echo "00 00 00 00 00         ">>CONTROL;\
		echo "00 00 00 00 00         ">>CONTROL;\
		echo "00 01 00               ">>CONTROL;\
		echo "2                      ">>CONTROL;\
		echo "1.0 1.0 1.0            ">>CONTROL;\
		echo "0.001 0.0 0.0 0.0 0.0  ">>CONTROL;\
		echo "0.0 8.0E-05 8.0E-05    ">>CONTROL;\
		echo "10960.0                ">>CONTROL;\
		echo "0.0                    ">>CONTROL;\
		echo "0.0 0.0 0.0            ">>CONTROL;\
		echo "0.01 0.0 0.0 0.0 0.0   ">>CONTROL;\
		echo "3.0 0.0 0.0            ">>CONTROL;\
		echo "8.0                    ">>CONTROL;\
		echo "0.0                    ">>CONTROL;\
		if [ -f cdump ];then rm cdump; fi ;\
		./hycs_std;\
		nlabel=`echo "$$name-$$label"`;\
		./conc2cdf -icdump -o$$nlabel.nc;\
		mv $$nlabel.nc $$label/ ;\
		mv CONTROL $$label/$$nlabel-CONTROL;\
		bzip2 $$label/$$nlabel-CONTROL;\
		bzip2 $$label/$$nlabel.nc &\
	done
